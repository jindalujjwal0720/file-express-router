"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[253],{9292:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"features/middlewares","title":"Middleware Management","description":"Middleware in file-express-router allows you to handle requests and responses by adding layers of logic between the client and your route handlers. You can apply middleware at the directory, giving you flexibility and control over how you manage requests. Additionally, error handling is streamlined with built-in support for error middleware, and the order in which middleware is applied can be controlled.","source":"@site/docs/features/middlewares.md","sourceDirName":"features","slug":"/features/middlewares","permalink":"/file-express-router/docs/features/middlewares","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/features/middlewares.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"HTTP Method Handlers","permalink":"/file-express-router/docs/features/http-methods"},"next":{"title":"Tutorials","permalink":"/file-express-router/docs/category/tutorials"}}');var t=i(4848),d=i(8453);const s={},l="Middleware Management",a={},o=[{value:"Directory-Level Middleware",id:"directory-level-middleware",level:2},{value:"Error Middleware",id:"error-middleware",level:2},{value:"Multiple Middleware",id:"multiple-middleware",level:2},{value:"Middleware Ordering",id:"middleware-ordering",level:2}];function c(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"middleware-management",children:"Middleware Management"})}),"\n",(0,t.jsxs)(r.p,{children:["Middleware in ",(0,t.jsx)(r.code,{children:"file-express-router"})," allows you to handle requests and responses by adding layers of logic between the client and your route handlers. You can apply middleware at the directory, giving you flexibility and control over how you manage requests. Additionally, error handling is streamlined with built-in support for error middleware, and the order in which middleware is applied can be controlled."]}),"\n",(0,t.jsx)(r.h2,{id:"directory-level-middleware",children:"Directory-Level Middleware"}),"\n",(0,t.jsxs)(r.p,{children:["You can apply middleware to all routes within a specific directory by placing a ",(0,t.jsx)(r.code,{children:"index.middleware.ts"})," file in that directory. This is ideal for scenarios like user authentication or logging, where the same middleware logic should be applied to multiple routes."]}),"\n",(0,t.jsx)(r.p,{children:"Example:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",metastring:'title="routes/users/index.middleware.ts"',children:"export default (req, res, next) => {\r\n  console.log('Middleware applied to all user routes');\r\n  next();\r\n};\n"})}),"\n",(0,t.jsx)(r.h2,{id:"error-middleware",children:"Error Middleware"}),"\n",(0,t.jsxs)(r.p,{children:["Error middlewares are just like regular middlewares, but they have an additional parameter for handling errors. You can define an error middleware function in a ",(0,t.jsx)(r.code,{children:"index.error.ts"})," file within a route directory to handle errors that occur during request processing. This is useful for logging errors, sending custom error responses, or performing cleanup operations."]}),"\n",(0,t.jsx)(r.p,{children:"Example:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",metastring:'title="routes/index.error.ts"',children:"export default (err, req, res, next) => {\r\n  console.error('Error occurred:', err);\r\n  res.status(500).json({ message: 'Internal Server Error' });\r\n};\n"})}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Note:"})," Error middleware is defined in a ",(0,t.jsx)(r.code,{children:"index.error.ts"})," file and is executed when an error is passed to the ",(0,t.jsx)(r.code,{children:"next()"})," function. If the error is normally thrown, it will not be caught by the error middleware. Error middleware only runs when ",(0,t.jsx)(r.code,{children:"next(err)"})," is called within a route or another middleware. Error middleware should have four parameters ",(0,t.jsx)(r.code,{children:"(err, req, res, next)"})," to handle errors correctly."]}),"\n",(0,t.jsx)(r.h2,{id:"multiple-middleware",children:"Multiple Middleware"}),"\n",(0,t.jsxs)(r.p,{children:["You can apply multiple middleware functions to a route by defining an array of middleware functions in the ",(0,t.jsx)(r.code,{children:"handler"})," property of the middleware file or by creating separate middleware files. This allows you to chain middleware functions together to process requests in a specific order."]}),"\n",(0,t.jsx)(r.p,{children:"Example using an array of middleware functions:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",metastring:'title="routes/users/index.middleware.ts"',children:"const authenticate = (req, res, next) => {\r\n  console.log('Authenticating user...');\r\n  next();\r\n};\r\n\r\nconst authorize = (req, res, next) => {\r\n  console.log('Authorizing user...');\r\n  next();\r\n};\r\n\r\nexport default [authenticate, authorize];\n"})}),"\n",(0,t.jsx)(r.p,{children:"Example using separate middleware files:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",metastring:'title="routes/users/authenticate.middleware.ts"',children:"export default (req, res, next) => {\r\n  console.log('Authenticating user...');\r\n  next();\r\n};\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-ts",metastring:'title="routes/users/authorize.middleware.ts"',children:"export default (req, res, next) => {\r\n  console.log('Authorizing user...');\r\n  next();\r\n};\n"})}),"\n",(0,t.jsxs)(r.p,{children:["In this example, the ",(0,t.jsx)(r.code,{children:"authenticate"})," middleware function is executed first, followed by the ",(0,t.jsx)(r.code,{children:"authorize"})," middleware function. This allows you to define a sequence of middleware functions to process requests in the desired order."]}),"\n",(0,t.jsx)(r.h2,{id:"middleware-ordering",children:"Middleware Ordering"}),"\n",(0,t.jsxs)(r.p,{children:["The order in which middleware is applied is crucial, as it determines the flow of execution. In ",(0,t.jsx)(r.code,{children:"file-express-router"}),", middleware is executed in the order it is defined if multiple middleware functions are applied to a single file."]}),"\n",(0,t.jsx)(r.p,{children:"But, if you have multiple middleware files in the same directory, the order of execution is based on the file names. The middleware files are sorted alphabetically, and the middleware functions are executed in that order."})]})}function u(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,r,i)=>{i.d(r,{R:()=>s,x:()=>l});var n=i(6540);const t={},d=n.createContext(t);function s(e){const r=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),n.createElement(d.Provider,{value:r},e.children)}}}]);